
(function(){var a=new Array();window.GDDMenu=GClass.create();GDDMenu.prototype={initialize:function(c,m){var p="toggle-menu-"+a.length;this.menu=$G(c);this.onClick=m;var q=this;var d=function(r){var i=$E(p);if(i){i.checked=r;if($E("slidemenu_content")&&q.menu.hasClass("slidemenu")){if(r){$G("slidemenu_content").addClass("showmenu")}else{$G("slidemenu_content").removeClass("showmenu")}}}};if(this.menu.tagName.toLowerCase()=="nav"){var h=$G(this.menu.getElementsByTagName("ul")[0]);if(this.menu.hasClass("topmenu slidemenu")){var k=$G().create("input",{type:"checkbox",id:p,className:"toggle-menu"});var o=$G(document.createElement("label"));if(this.menu.hasClass("responsive")){this.menu.insertBefore(k,h);this.menu.insertBefore(o,k)}else{if($E("slidemenu_content")){$E("slidemenu_content").parentNode.insertBefore(k,$E("slidemenu_content"))}else{this.menu.parentNode.insertBefore(k,this.menu)}this.menu.insertBefore(o,h)}o.className="toggle-menu";o.set("for",p);o.tabIndex=1;o.addEvent("click",function(i){d(!k.checked);GEvent.stop(i)});o.addEvent("keydown",function(i){if(GEvent.keyCode(i)==32){d(!k.checked)}});for(var f=0;f<3;f++){o.appendChild(document.createElement("span"))}}this.menu=h}this.id="GDDmenu"+a.length;var j=function(t){var i=$G(GEvent.element(t).parentNode);var s=GEvent.keyCode(t);if(i.hasClass("toplevelmenu")){if(s==37){q.select(q.currItem,-1,true);GEvent.stop(t)}else{if(s==39){q.select(q.currItem,1,true);GEvent.stop(t)}else{if(s==40){i=i.getElementsByTagName("li")[0];if(i){q.select(i,0,true);GEvent.stop(t)}}}}}else{if(s==9){q.selectTop(i,1,true);GEvent.stop(t)}else{if(s==37){i=i.parentNode.parentNode;if(i){if($G(i).hasClass("toplevelmenu")){q.select(i,-1,true)}else{q.select(i,0,true)}GEvent.stop(t)}}else{if(s==38){q.select(i,-1,true);GEvent.stop(t)}else{if(s==39){var r=i.getElementsByTagName("li");if(r.length>0){q.select(r[0],0,true)}else{q.selectTop(i,1,true)}GEvent.stop(t)}else{if(s==40){q.select(i,1,true);GEvent.stop(t)}}}}}}};var b=function(i){window.clearTimeout(q.blurTime);q.select(this.parentNode,0,true)};var e=function(i){q.select(this,0);GEvent.stop(i)};var n=function(i){q.blurItem=this.parentNode;q.blurTime=window.setTimeout(function(){q.select(q.blurItem,null,false)},1);GEvent.stop(i)};var l=function(i){this.removeClass("hover focus")};function g(s,t,v){var i=s.firstChild;while(i){if(i.tagName&&i.tagName.toLowerCase()=="li"){$G(i).addEvent("mouseover",e);i.addEvent("mouseout",l);var r=$G(i.getElementsByTagName("a")[0]);r.addEvent("focus",b);r.addEvent("blur",n);var u=i.getElementsByTagName("ul");if(t>0){r.tabIndex=t;i.addClass(v+" toplevelmenu")}else{i.addClass(v+" sublevelmenu")}if(u.length>0){g(u[0],0,v)}}i=i.nextSibling}}g(this.menu,1,this.id);this.menu.tabIndex=0;this.menu.addEvent("keydown",j);this.menu.addEvent("click",function(r){var i=GEvent.element(r).parentNode;if(i.tagName.toLowerCase()=="a"&&(i.href!=""||i.parentNode.getElementsByTagName("li").length==0)){d(false);if(Object.isFunction(q.onClick)){q.onClick.call(i)}}});a.push(this)},selectTop:function(c,d,e){var b=c;while(b&&b.tagName.toLowerCase()=="li"&&$G(b).hasClass(this.id)){c=b;b=b.parentNode.parentNode}this.select(c,d,e)},select:function(b,d,e){var i,h=b.parentNode.firstChild,g=new Array(),c=this;if(d==null){b=true}else{if(d==1){b=c.nextNode(b)}else{if(d==-1){b=c.previousNode(b)}}}if(b){while(h){if(h==b){i=h;while(i&&i.tagName.toLowerCase()=="li"&&$G(i).hasClass(this.id)){g.push(i);i=i.parentNode.parentNode}}h=c.nextNode(h)}forEach(this.menu.getElementsByTagName("li"),function(){if(g.indexOf(this)>-1){if(this==b){c.currItem=this;if(e){c.firstNode(this).focus();this.addClass("focus")}}this.addClass("hover")}else{this.removeClass("hover focus")}})}},nextNode:function(b){b=b.nextSibling;while(b&&b.nodeType==3){b=b.nextSibling}return b},previousNode:function(b){b=b.previousSibling;while(b&&b.nodeType==3){b=b.previousSibling}return b},firstNode:function(b){b=b.firstChild;while(b&&b.nodeType==3){b=b.nextSibling}return b}}}());